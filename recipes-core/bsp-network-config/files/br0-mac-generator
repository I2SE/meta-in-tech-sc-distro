#!/bin/sh

# following directories are not used at all since we create dynamic configuration
NORMALDIR="$1"
EARLYDIR="$2"
LATEDIR="$3"

# obtain MAC address of ethernet interface
MAC=$(cat /sys/class/net/eth0/address 2>/dev/null)
[ -n "$MAC" ] || exit 0

# we create a configuration for br0 interface, so this is hardcoded path
CFGFILE=/run/systemd/network/br0.netdev.d/mac.conf
mkdir -p $(dirname $CFGFILE)

# cat with here-document not possible due to /tmp being ro
script=$0
echo "# auto-generated by $script
[NetDev]
MACAddress=$MAC" > "$CFGFILE"
